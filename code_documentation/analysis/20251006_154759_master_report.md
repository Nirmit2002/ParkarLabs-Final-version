# ParkarLabs – Master Project Report
_Generated: 2025-10-06T15:47:59+00:00_

## Environment
- Repo root: `/root/ParkarLabs`
- OS: `Linux PT013DT 6.6.87.2-microsoft-standard-WSL2 #1 SMP PREEMPT_DYNAMIC Thu Jun  5 18:30:46 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux`
- Bash: `5.2.21(1)-release`
- Node: `v22.19.0`
- npm:  `10.9.3`
- pnpm: `not found`
- yarn: `not found`
- psql: `psql (PostgreSQL) 16.10 (Ubuntu 16.10-0ubuntu0.24.04.1)`

### backend package.json
- name: parkarlabs-backend
- version: 1.0.0
- scripts: dev, start, test, migrate:up, migrate:down, seed
- dependencies: axios, bcryptjs, cors, csv-parser, dotenv, express, express-rate-limit, express-session, express-validator, helmet, jsonwebtoken, morgan, multer, node-cron, passport, pg, ssh2, ws
- devDependencies: jest, nodemon, supertest

### frontend package.json
- name: parkarlabs-frontend
- version: 1.0.0
- scripts: dev, build, start, lint
- dependencies: autoprefixer, axios, class-variance-authority, clsx, lucide-react, next, postcss, react, react-dom, react-hook-form, react-hot-toast, react-query, tailwindcss, xterm, xterm-addon-fit
- devDependencies: @types/react, @types/react-dom, eslint, eslint-config-next

## Backend
- Route files: **7**
- Routes detected: **31**
- Controllers detected: **5**
- Files with DB queries: **12**

### Mount Points
- /api/ ⟶ limiter _(in backend/src/server.js)_
- /api/auth ⟶ ./routes/auth _(in backend/src/server.js)_
- /api/admin ⟶ ./routes/admin _(in backend/src/server.js)_
- /api/user ⟶ ./routes/user _(in backend/src/server.js)_
- /api/courses ⟶ ./routes/courses _(in backend/src/server.js)_
- /api/tasks ⟶ ./routes/tasks _(in backend/src/server.js)_
- /api/containers ⟶ ./routes/containers _(in backend/src/server.js)_
- /api/users ⟶ usersRoutes _(in backend/src/server.js)_

### Routes (method path → file)
- [GET] /  — `backend/src/routes/courses.js`
- [GET] /  — `backend/src/routes/tasks.js`
- [GET] /  — `backend/src/routes/users.js`
- [POST] /  — `backend/src/routes/courses.js`
- [POST] /  — `backend/src/routes/tasks.js`
- [POST] /  — `backend/src/routes/users.js`
- [DELETE] /:id  — `backend/src/routes/courses.js`
- [DELETE] /:id  — `backend/src/routes/tasks.js`
- [DELETE] /:id  — `backend/src/routes/users.js`
- [GET] /:id  — `backend/src/routes/courses.js`
- [GET] /:id  — `backend/src/routes/users.js`
- [PUT] /:id  — `backend/src/routes/courses.js`
- [PUT] /:id  — `backend/src/routes/users.js`
- [POST] /:id/assign  — `backend/src/routes/tasks.js`
- [POST] /:id/modules  — `backend/src/routes/courses.js`
- [DELETE] /:id/modules/:moduleId  — `backend/src/routes/courses.js`
- [PUT] /:id/modules/:moduleId  — `backend/src/routes/courses.js`
- [PATCH] /:id/status  — `backend/src/routes/tasks.js`
- [POST] /launch  — `backend/src/routes/containers.js`
- [POST] /login  — `backend/src/routes/auth.js`
- [POST] /logout  — `backend/src/routes/auth.js`
- [GET] /my-tasks  — `backend/src/routes/tasks.js`
- [GET] /profile  — `backend/src/routes/auth.js`
- [POST] /register  — `backend/src/routes/auth.js`
- [GET] /roles  — `backend/src/routes/users.js`
- [GET] /stats  — `backend/src/routes/users.js`
- [GET] /test  — `backend/src/routes/admin.js`
- [GET] /test  — `backend/src/routes/auth.js`
- [GET] /test  — `backend/src/routes/user.js`
- [GET] /users  — `backend/src/routes/auth.js`
- [GET] /verify  — `backend/src/routes/auth.js`

### Controllers (heuristic methods)
- backend/src/controllers/auth.js: async
- backend/src/controllers/containers.js: async
- backend/src/controllers/courses.js: async
- backend/src/controllers/tasks.js: async
- backend/src/controllers/users.js: async

### DB query callsites (first 120 chars)
- backend/config/database.js: `SELECT NOW()`
- backend/src/controllers/auth.js: ` SELECT id, email FROM users WHERE email = $1 `
- backend/src/controllers/auth.js: ` SELECT id FROM roles WHERE name = `
- backend/src/controllers/auth.js: `BEGIN`
- backend/src/controllers/auth.js: ` INSERT INTO users (azure_ad_id, name, email, role_id, status, created_at) VALUES ($1, $2, $3, $4, `
- backend/src/controllers/auth.js: ` INSERT INTO sessions (user_id, provider, provider_account_id, meta, created_at) VALUES ($1, `
- backend/src/controllers/auth.js: ` INSERT INTO audit_logs (actor_user_id, action, target_type, target_id, meta, created_at) VALUES ($1, `
- backend/src/controllers/auth.js: `COMMIT`
- backend/src/controllers/auth.js: `ROLLBACK`
- backend/src/controllers/auth.js: ` SELECT u.id, u.email, u.name, u.azure_ad_id, u.status, r.name as role_name FROM users u LEFT JOIN rol...`
- backend/src/controllers/auth.js: ` SELECT meta FROM sessions WHERE user_id = $1 AND provider = `
- backend/src/controllers/auth.js: ` INSERT INTO audit_logs (actor_user_id, action, target_type, target_id, meta, created_at) VALUES ($1, `
- backend/src/controllers/auth.js: ` SELECT u.id, u.name, u.email, u.status, u.created_at, r.name as role_name, r.description as role_des...`
- backend/src/controllers/auth.js: ` INSERT INTO audit_logs (actor_user_id, action, target_type, target_id, meta, created_at) VALUES ($1, `
- backend/src/controllers/containers.js: `BEGIN`
- backend/src/controllers/containers.js: `SELECT check_and_reserve_quota($1, $2)`
- backend/src/controllers/containers.js: `UPDATE containers SET status_id = (SELECT id FROM container_statuses WHERE name=`
- backend/src/controllers/containers.js: `INSERT INTO audit_logs (actor_user_id, action, target_type, target_id, meta, created_at) VALUES ($1, `
- backend/src/controllers/containers.js: `COMMIT`
- backend/src/controllers/containers.js: `ROLLBACK`
- backend/src/controllers/courses.js: ` SELECT c.id, c.title, c.slug, c.description, c.visibility, c.created_at, u.name as created_by_na...`
- backend/src/controllers/courses.js: ` SELECT c.id, c.title, c.slug, c.description, c.visibility, c.created_at, u.name as created_by_na...`
- backend/src/controllers/courses.js: ` SELECT id, title, content, position, created_at FROM modules WHERE course_id = $1 ORDER BY po...`
- backend/src/controllers/courses.js: `SELECT id FROM courses WHERE slug = $1`
- backend/src/controllers/courses.js: ` INSERT INTO courses (title, slug, description, created_by, visibility, created_at) VALUES ($1, $2, $3, $4, ...`
- backend/src/controllers/courses.js: ` UPDATE courses SET title = COALESCE($1, title), slug = COALESCE($2, slug), description...`
- backend/src/controllers/courses.js: `DELETE FROM courses WHERE id = $1 RETURNING id`
- backend/src/controllers/courses.js: ` INSERT INTO modules (course_id, title, content, position, created_at) VALUES ($1, $2, $3, $4, NOW()) ...`
- backend/src/controllers/courses.js: ` UPDATE modules SET title = COALESCE($1, title), content = COALESCE($2, content), posit...`
- backend/src/controllers/courses.js: `DELETE FROM modules WHERE id = $1 AND course_id = $2 RETURNING id`
- backend/src/controllers/tasks.js: ` SELECT t.*, u.name as created_by_name, c.title as course_title, COUNT(a.id) as assignment_count, ...`
- backend/src/controllers/tasks.js: ` SELECT a.id as assignment_id, a.status, a.due_date, a.created_at as assigned_at, t.id as task_id, t....`
- backend/src/controllers/tasks.js: ` INSERT INTO tasks (title, description, created_by, related_course_id, created_at) VALUES ($1, $2, $3, $4, N...`
- backend/src/controllers/tasks.js: `SELECT id, title FROM tasks WHERE id = $1`
- backend/src/controllers/tasks.js: `SELECT id, name, email FROM users WHERE id = ANY($1) AND status = $2`
- backend/src/controllers/tasks.js: `SELECT id FROM assignments WHERE task_id = $1 AND assigned_to_user_id = $2`
- backend/src/controllers/tasks.js: ` INSERT INTO assignments ( task_id, assigned_to_user_id, assigned_by, status, due_date, metada...`
- backend/src/controllers/tasks.js: `SELECT id, task_id, status FROM assignments WHERE id = $1 AND assigned_to_user_id = $2`
- backend/src/controllers/tasks.js: `UPDATE assignments SET status = $1 WHERE id = $2`
- backend/src/controllers/tasks.js: `SELECT id, title FROM tasks WHERE id = $1`
- backend/src/controllers/tasks.js: `DELETE FROM tasks WHERE id = $1`
- backend/src/controllers/users.js: `SELECT id FROM users WHERE email = $1`
- backend/src/controllers/users.js: `SELECT id FROM users WHERE azure_ad_id = $1`
- backend/src/controllers/users.js: `SELECT id, name FROM roles WHERE id = $1`
- backend/src/controllers/users.js: `INSERT INTO audit_logs (actor_user_id, action, target_type, target_id, meta, created_at) VALUES ($1, `
- backend/src/controllers/users.js: `SELECT * FROM users WHERE id = $1`
- backend/src/controllers/users.js: `SELECT id FROM users WHERE email = $1 AND id != $2`
- backend/src/controllers/users.js: `SELECT id, name FROM roles WHERE id = $1`
- backend/src/controllers/users.js: `INSERT INTO audit_logs (actor_user_id, action, target_type, target_id, meta, created_at) VALUES ($1, `
- backend/src/controllers/users.js: `SELECT * FROM users WHERE id = $1`
- backend/src/controllers/users.js: `INSERT INTO audit_logs (actor_user_id, action, target_type, target_id, meta, created_at) VALUES ($1, `
- backend/src/middleware/auth.js: ` SELECT u.id, u.email, u.name, u.status, r.name as role_name FROM users u LEFT JOIN roles r ON u.role_...`
- backend/src/routes/admin.js: ` SELECT (SELECT COUNT(*) FROM users) as total_users, (SELECT COUNT(*) FROM courses) as total_cour...`
- backend/src/routes/auth.js: `SELECT COUNT(*) as user_count FROM users`
- backend/src/routes/auth.js: ` SELECT u.id, u.name, u.email, u.status, u.created_at, r.name as role_name, r.description as role_des...`
- backend/src/routes/user.js: ` SELECT COUNT(*) as my_assignments, COUNT(CASE WHEN status = `
- backend/src/routes/users.js: `page`
- backend/src/routes/users.js: `limit`
- backend/src/routes/users.js: `search`
- backend/src/routes/users.js: `role`
- backend/src/routes/users.js: `status`
- backend/src/routes/users.js: `sortBy`
- backend/src/routes/users.js: `sortOrder`
- backend/src/services/database.js: `BEGIN`
- backend/src/services/database.js: `COMMIT`
- backend/src/services/database.js: `ROLLBACK`
- backend/src/services/database.js: `SELECT 1 as ok`

## Frontend
- Frontend source files scanned: **13**
- Pages/layouts detected: **0**
- app route handlers (route.ts/js): **0**

### Frontend API calls (matched to backend)
- Total API calls found: **25**
- Matched to backend routes: **21**
- Unmatched: **4**

| Method | Frontend File | URL | Backend Path | Route File | DB? |
|---|---|---|---|---|---|
| GET | frontend/pages/admin/courses.js | /api/courses | / | backend/src/routes/courses.js | No |
| POST | frontend/pages/admin/courses.js | /api/courses | / | backend/src/routes/courses.js | No |
| DELETE | frontend/pages/admin/courses.js | /api/courses/${courseId} | — | — | No |
| GET | frontend/pages/admin/dashboard.js | /api/admin/test | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/admin/dashboard.js | /api/auth/users | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/admin/tasks.js | /api/tasks | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/admin/tasks.js | /api/auth/users | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/admin/tasks.js | /api/courses | / | backend/src/routes/courses.js | No |
| POST | frontend/pages/admin/tasks.js | /api/tasks | / | backend/src/routes/courses.js | No |
| POST | frontend/pages/admin/tasks.js | /api/tasks/${selectedTask.id}/assign | / | backend/src/routes/courses.js | No |
| DELETE | frontend/pages/admin/tasks.js | /api/tasks/${taskId} | — | — | No |
| GET | frontend/pages/admin/users.js | ${API_BASE_URL}/api/users | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/admin/users.js | ${API_BASE_URL}/api/users/roles | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/admin/users.js | ${API_BASE_URL}/api/users/stats | / | backend/src/routes/courses.js | No |
| POST | frontend/pages/admin/users.js | ${API_BASE_URL}/api/users | / | backend/src/routes/courses.js | No |
| PUT | frontend/pages/admin/users.js | ${API_BASE_URL}/api/users/${selectedUser.id} | — | — | No |
| DELETE | frontend/pages/admin/users.js | ${API_BASE_URL}/api/users/${selectedUser.id} | — | — | No |
| GET | frontend/pages/admin/users.js | ${API_BASE_URL}/api/users/${user.id} | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/auth/login.js | /api/auth/verify | / | backend/src/routes/courses.js | No |
| POST | frontend/pages/auth/login.js | /api/auth/login | / | backend/src/routes/courses.js | No |
| POST | frontend/pages/auth/login.js | /api/auth/register | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/user/dashboard.js | /api/user/test | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/user/dashboard.js | /api/tasks/my-tasks | / | backend/src/routes/courses.js | No |
| GET | frontend/pages/user/tasks.js | /api/tasks/my-tasks | / | backend/src/routes/courses.js | No |
| POST | frontend/pages/user/tasks.js | /api/containers/launch | / | backend/src/routes/courses.js | No |

## Database (brief summary)

### Tables
- users
- teams
- user_teams

### Functions

### Triggers

### Views

